(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{288:function(e,t,s){"use strict";s.r(t);var a=s(28),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"kubernetes-ä½¿ç”¨æ€»ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-ä½¿ç”¨æ€»ç»“"}},[e._v("#")]),e._v(" Kubernetes ä½¿ç”¨æ€»ç»“")]),e._v(" "),s("p",[e._v("Kubernetes ç®€ç§° k8sï¼Œæ˜¯ google åœ¨ 2014 å¹´å‘å¸ƒçš„ä¸€ä¸ªå¼€æºé¡¹ç›®ã€‚")]),e._v(" "),s("p",[e._v("Kubernetes è§£å†³äº†å“ªäº›é—®é¢˜ï¼Ÿ")]),e._v(" "),s("p",[e._v("çœŸå®çš„ç”Ÿäº§ç¯å¢ƒåº”ç”¨ä¼šåŒ…å«å¤šä¸ªå®¹å™¨ï¼Œè€Œè¿™äº›å®¹å™¨è¿˜å¾ˆå¯èƒ½ä¼šè·¨è¶Šå¤šä¸ªæœåŠ¡å™¨ä¸»æœºéƒ¨ç½²ã€‚Kubernetes æä¾›äº†ä¸ºé‚£äº›å·¥ä½œè´Ÿè½½å¤§è§„æ¨¡éƒ¨ç½²å®¹å™¨çš„ç¼–æ’ä¸ç®¡ç†èƒ½åŠ›ã€‚Kubernetes ç¼–æ’è®©ä½ èƒ½å¤Ÿæ„å»ºå¤šå®¹å™¨çš„åº”ç”¨æœåŠ¡ï¼Œåœ¨é›†ç¾¤ä¸Šè°ƒåº¦æˆ–ä¼¸ç¼©è¿™äº›å®¹å™¨ï¼Œä»¥åŠç®¡ç†å®ƒä»¬éšæ—¶é—´å˜åŒ–çš„å¥åº·çŠ¶æ€ã€‚")]),e._v(" "),s("ul",[s("li",[e._v("kubernetes åŸºç¡€")]),e._v(" "),s("li",[e._v("kubernetes ä¼˜åŒ–")]),e._v(" "),s("li",[e._v("kubernetes å®æˆ˜")])]),e._v(" "),s("p",[e._v("Kubernetes åŸºç¡€æ¦‚å¿µå¾ˆå¤šï¼Œç¬¬ä¸€æ¬¡æ¥è§¦å®¹æ˜“çœ‹æ™•ï¼Œå¦‚æœæ˜¯æ–°æ‰‹ï¼Œå»ºè®®ç›´æ¥çœ‹å®æˆ˜éƒ¨åˆ†ï¼Œå…ˆè·‘èµ·æ¥å†è¯´ã€‚")]),e._v(" "),s("h2",{attrs:{id:"kubernetes-åŸºç¡€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-åŸºç¡€"}},[e._v("#")]),e._v(" kubernetes åŸºç¡€")]),e._v(" "),s("p",[e._v("k8s ä¸­æœ‰å‡ ä¸ªé‡è¦æ¦‚å¿µã€‚")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("æ¦‚å¿µ")]),e._v(" "),s("th",[e._v("ä»‹ç»")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("cluster")]),e._v(" "),s("td",[e._v("ä¸€ä¸ª k8s é›†ç¾¤")])]),e._v(" "),s("tr",[s("td",[e._v("master")]),e._v(" "),s("td",[e._v("é›†ç¾¤ä¸­çš„ä¸€å°æœºå™¨ï¼Œæ˜¯é›†ç¾¤çš„æ ¸å¿ƒï¼Œè´Ÿè´£æ•´ä¸ªé›†ç¾¤çš„ç®¡ç†å’Œæ§åˆ¶")])]),e._v(" "),s("tr",[s("td",[e._v("node")]),e._v(" "),s("td",[e._v("é›†ç¾¤ä¸­çš„ä¸€å°æœºå™¨ï¼Œæ˜¯é›†ç¾¤ä¸­çš„å·¥ä½œè´Ÿè½½èŠ‚ç‚¹")])]),e._v(" "),s("tr",[s("td",[e._v("pod")]),e._v(" "),s("td",[e._v("k8s æœ€å°è°ƒåº¦å•ä½ï¼Œæ¯ä¸ª pod åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨")])]),e._v(" "),s("tr",[s("td",[e._v("label")]),e._v(" "),s("td",[e._v("ä¸€ä¸ª key = value é”®å€¼å¯¹ï¼Œå¯ä»¥é™„åŠ åˆ°å„ç§èµ„æºå¯¹è±¡ä¸Šï¼Œæ–¹ä¾¿å…¶ä»–èµ„æºè¿›è¡ŒåŒ¹é…")])]),e._v(" "),s("tr",[s("td",[e._v("controller")]),e._v(" "),s("td",[e._v("k8s é€šè¿‡ controller æ¥ç®¡ç† pod")])]),e._v(" "),s("tr",[s("td",[e._v("service")]),e._v(" "),s("td",[e._v("å¯¹å¤–æä¾›ç»Ÿä¸€çš„æœåŠ¡ï¼Œè‡ªåŠ¨å°†è¯·æ±‚åˆ†å‘åˆ°æ­£ç¡®çš„ pod å¤„")])]),e._v(" "),s("tr",[s("td",[e._v("namespace")]),e._v(" "),s("td",[e._v("å°† cluster é€»è¾‘ä¸Šåˆ’åˆ†æˆå¤šä¸ªè™šæ‹Ÿ clusterï¼Œæ¯ä¸ª cluster å°±æ˜¯ä¸€ä¸ª namespace")])])])]),e._v(" "),s("h3",{attrs:{id:"cluster"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cluster"}},[e._v("#")]),e._v(" Cluster")]),e._v(" "),s("p",[e._v("Cluster ä»£è¡¨ä¸€ä¸ª k8s é›†ç¾¤ï¼Œæ˜¯è®¡ç®—ã€å­˜å‚¨å’Œç½‘ç»œèµ„æºçš„é›†åˆï¼Œk8s åˆ©ç”¨è¿™äº›èµ„æºè¿è¡Œå„ç§åŸºäºå®¹å™¨çš„åº”ç”¨ã€‚")]),e._v(" "),s("h3",{attrs:{id:"master-èŠ‚ç‚¹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#master-èŠ‚ç‚¹"}},[e._v("#")]),e._v(" Master èŠ‚ç‚¹")]),e._v(" "),s("p",[e._v("Master æ˜¯ cluster çš„å¤§è„‘ï¼Œè¿è¡Œç€çš„æœåŠ¡åŒ…æ‹¬ kube-apiserverã€kube-schedulerã€kube-controller-managerã€etcd å’Œ pod ç½‘ç»œã€‚")]),e._v(" "),s("ul",[s("li",[s("strong",[e._v("kube-apiserver")]),e._v(" "),s("ul",[s("li",[e._v("apiserver æ˜¯ k8s cluster çš„å‰ç«¯æ¥å£ï¼Œæä¾› restful apiã€‚å„ç§å®¢æˆ·ç«¯å·¥å…·ä»¥åŠ k8s å…¶ä»–ç»„ä»¶å¯ä»¥é€šè¿‡å®ƒç®¡ç† cluster ä¸­çš„å„ç§èµ„æºã€‚")])])]),e._v(" "),s("li",[s("strong",[e._v("kube-scheduler")]),e._v(" "),s("ul",[s("li",[e._v("è´Ÿè´£å†³å®šå°† pod æ”¾åœ¨å“ªä¸ª node ä¸Šè¿è¡Œï¼Œscheduler åœ¨è°ƒåº¦æ—¶ä¼šå……åˆ†è€ƒè™‘ cluster ä¸­å„ä¸ªèŠ‚ç‚¹çš„è´Ÿè½½ï¼Œä»¥åŠåº”ç”¨å¯¹é«˜å¯ç”¨ã€æ€§èƒ½ã€æ•°æ®äº²å’Œæ€§çš„éœ€æ±‚ã€‚")])])]),e._v(" "),s("li",[s("strong",[e._v("kube-controller-manager")]),e._v(" "),s("ul",[s("li",[e._v("è´Ÿè´£ç®¡ç† cluster å„ç§èµ„æºï¼Œä¿è¯èµ„æºå¤„ç†é¢„æœŸçŠ¶æ€ã€‚controller-manager ç”±å¤šç§ controller ç»„æˆï¼ŒåŒ…æ‹¬ replication controllerï¼Œendpoint controllerï¼Œnamespace controllerï¼Œserviceaccount controller ç­‰ã€‚")]),e._v(" "),s("li",[e._v("ä¸åŒçš„ controller ç®¡ç†ä¸åŒçš„èµ„æºï¼Œä¾‹å¦‚ï¼šreplication controller ç®¡ç† deployment ï¼Œstatefulsetï¼Œdamonset çš„ç”Ÿå‘½å‘¨æœŸï¼Œnamespace controller èµ„æºç®¡ç† namespace èµ„æºã€‚")])])]),e._v(" "),s("li",[s("strong",[e._v("etcd")]),e._v("ï¼ˆåˆ†å¸ƒå¼ key-value å­˜å‚¨åº“ï¼‰\n"),s("ul",[s("li",[e._v("è´Ÿè´£ä¿å­˜ cluster çš„é…ç½®ä¿¡æ¯å’Œå„ç§èµ„æºçš„çŠ¶æ€ä¿¡æ¯ã€‚å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œetcd ä¼šå¿«é€Ÿåœ°é€šçŸ¥ k8s ç›¸å…³ç»„ä»¶ã€‚")])])]),e._v(" "),s("li",[s("strong",[e._v("pod ç½‘ç»œ")]),e._v(" "),s("ul",[s("li",[e._v("pod è¦èƒ½å¤Ÿé€šä¿¡ï¼Œcluster å¿…é¡»éƒ¨ç½² pod ç½‘ç»œï¼Œflannel æ˜¯å…¶ä¸­ä¸€ä¸ªå¯é€‰æ–¹æ¡ˆã€‚")])])])]),e._v(" "),s("h3",{attrs:{id:"node-èŠ‚ç‚¹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node-èŠ‚ç‚¹"}},[e._v("#")]),e._v(" Node èŠ‚ç‚¹")]),e._v(" "),s("p",[e._v("Node èŠ‚ç‚¹ æ˜¯ pod è¿è¡Œçš„åœ°æ–¹ã€‚node èŠ‚ç‚¹ä¸Šè¿è¡Œçš„ k8s ç»„ä»¶æœ‰ kubeletã€kube-proxy å’Œ pod ç½‘ç»œã€‚")]),e._v(" "),s("ul",[s("li",[s("strong",[e._v("kubelet")]),e._v(" "),s("ul",[s("li",[e._v("kubelet æ˜¯ node èŠ‚ç‚¹çš„ä»£ç†ï¼Œå½“ master èŠ‚ç‚¹ä¸­ kube-scheduler ç¡®å®šåœ¨æŸä¸ª node èŠ‚ç‚¹ä¸Šè¿è¡Œ pod åï¼Œä¼šå°† pod çš„å…·ä½“é…ç½®ä¿¡æ¯å‘é€ç»™è¯¥èŠ‚ç‚¹çš„ kubeletï¼Œkubelet æ ¹æ®è¿™äº›ä¿¡æ¯åˆ›å»ºå’Œè¿è¡Œå®¹å™¨ï¼Œå¹¶å‘ master èŠ‚ç‚¹æŠ¥å‘Šè¿è¡ŒçŠ¶æ€ã€‚")])])]),e._v(" "),s("li",[s("strong",[e._v("kube-proxy")]),e._v(" "),s("ul",[s("li",[e._v("æ¯ä¸ª node èŠ‚ç‚¹éƒ½ä¼šè¿è¡Œ kube-proxy æœåŠ¡ï¼Œå®ƒè´Ÿè´£å°†è®¿é—® service çš„è¯·æ±‚è½¬å‘åˆ°åç«¯çš„å®¹å™¨ã€‚å¦‚æœæœ‰å¤šä¸ªå‰¯æœ¬ï¼Œkube-proxy ä¼šå®ç°è´Ÿè½½å‡è¡¡ã€‚")])])]),e._v(" "),s("li",[s("strong",[e._v("pod ç½‘ç»œ")]),e._v(" "),s("ul",[s("li",[e._v("pod è¦èƒ½å¤Ÿç›¸äº’é€šä¿¡ï¼Œk8s cluster å¿…é¡»éƒ¨ç½² pod ç½‘ç»œï¼Œflannel æ˜¯å…¶ä¸­ä¸€ä¸ªå¯é€‰æ–¹æ¡ˆã€‚")])])])]),e._v(" "),s("h3",{attrs:{id:"pod"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pod"}},[e._v("#")]),e._v(" Pod")]),e._v(" "),s("p",[e._v("æ¯ä¸€ä¸ª pod åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª containerï¼Œpod ä¸­çš„å®¹å™¨ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢« master è°ƒåº¦åˆ° node èŠ‚ç‚¹ä¸Šè¿è¡Œã€‚")]),e._v(" "),s("p",[e._v("ä¸ºä»€ä¹ˆ k8s ä½¿ç”¨ pod ç®¡ç†å®¹å™¨ï¼Œè€Œä¸æ˜¯ç›´æ¥æ“ä½œå®¹å™¨ï¼Ÿ")]),e._v(" "),s("p",[e._v("1ã€å› ä¸ºæœ‰äº›å®¹å™¨å¤©ç”Ÿå°±æ˜¯éœ€è¦ç´§å¯†çš„è”ç³»ï¼Œæ”¾åœ¨ä¸€ä¸ª pod ä¸­è¡¨ç¤ºä¸€ä¸ªå®Œæ•´çš„æœåŠ¡ï¼Œk8s åŒæ—¶ä¼šåœ¨æ¯ä¸ª pod ä¸­åŠ å…¥ pause å®¹å™¨ï¼Œæ¥ç®¡ç†å†…éƒ¨å®¹å™¨ç»„çš„çŠ¶æ€ã€‚")]),e._v(" "),s("p",[e._v("2ã€Pod ä¸­çš„æ‰€æœ‰å®¹å™¨å…±äº« ipï¼Œå…±äº« volumeï¼Œæ–¹ä¾¿è¿›è¡Œå®¹å™¨ä¹‹é—´é€šä¿¡å’Œæ•°æ®å…±äº«ã€‚")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("ä»€ä¹ˆæ—¶å€™éœ€è¦åœ¨ pod ä¸­å®šä¹‰å¤šä¸ªå®¹å™¨ï¼Ÿ")]),e._v(" "),s("p",[e._v("ç­”ï¼šè¿™äº›å®¹å™¨è”ç³»éå¸¸ç´§å¯†ï¼Œè€Œä¸”éœ€è¦ç›´æ¥å…±äº«èµ„æºï¼Œä¾‹å¦‚ä¸€ä¸ªçˆ¬è™«ç¨‹åºï¼Œå’Œä¸€ä¸ª web server ç¨‹åºã€‚web server å¼ºçƒˆä¾èµ–çˆ¬è™«ç¨‹åºæä¾›æ•°æ®æ”¯æŒã€‚")])]),e._v(" "),s("h3",{attrs:{id:"label"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#label"}},[e._v("#")]),e._v(" Label")]),e._v(" "),s("p",[e._v("Label æ˜¯ä¸€ä¸ª key = value çš„é”®å€¼å¯¹ï¼Œå…¶ä¸­ key å’Œ value éƒ½ç”±ç”¨æˆ·è‡ªå·±æŒ‡å®šã€‚")]),e._v(" "),s("p",[e._v("Label çš„ä½¿ç”¨åœºæ™¯ï¼š")]),e._v(" "),s("ul",[s("li",[e._v("kube-controller\n"),s("ul",[s("li",[e._v("é€šè¿‡ label selecter ç­›é€‰å‡ºè¦ç›‘æ§çš„ pod å‰¯æœ¬ï¼Œä½¿ pod å‰¯æœ¬æ•°é‡ç¬¦åˆé¢„æœŸã€‚")])])]),e._v(" "),s("li",[e._v("kube-proxy\n"),s("ul",[s("li",[e._v("é€šè¿‡ label selecter é€‰æ‹©å¯¹åº”çš„ podï¼Œè‡ªåŠ¨å»ºç«‹æ¯ä¸ª service åˆ°å¯¹åº” pod çš„è¯·æ±‚è½¬å‘è·¯ç”±è¡¨ï¼Œä»è€Œå®ç° service çš„æ™ºèƒ½è´Ÿè½½å‡è¡¡æœºåˆ¶ã€‚")])])]),e._v(" "),s("li",[e._v("é€šè¿‡å¯¹ node å®šä¹‰ labelï¼Œåœ¨ pod ä¸­ä½¿ç”¨ node selector åŒ¹é…ï¼Œkube-scheduler è¿›ç¨‹å¯ä»¥å®ç° pod å®šå‘è°ƒåº¦çš„ç‰¹æ€§ã€‚")])]),e._v(" "),s("p",[e._v("æ€»ä¹‹ï¼Œlabel å¯ä»¥ç»™å¯¹è±¡åˆ›å»ºå¤šç»„æ ‡ç­¾ï¼Œlabel å’Œ label selecter å…±åŒæ„å»ºäº† k8s ç³»ç»Ÿä¸­æ ¸å¿ƒçš„åº”ç”¨æ¨¡å‹ï¼Œä½¿å¾—è¢«ç®¡ç†å¯¹è±¡èƒ½å¤Ÿè¢«ç²¾ç»†åœ°åˆ†ç»„ç®¡ç†ï¼ŒåŒæ—¶å®ç°äº†æ•´ä¸ªé›†ç¾¤çš„é«˜å¯ç”¨æ€§ã€‚")]),e._v(" "),s("h3",{attrs:{id:"controller"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#controller"}},[e._v("#")]),e._v(" Controller")]),e._v(" "),s("p",[e._v("k8s é€šå¸¸ä¸ä¼šç›´æ¥åˆ›å»º podï¼Œè€Œæ˜¯é€šè¿‡ controller æ¥ç®¡ç† podã€‚controller ä¸­å®šä¹‰äº† pod çš„éƒ¨ç½²ç‰¹æ€§ï¼Œæ¯”å¦‚æœ‰å‡ ä¸ªå‰¯æœ¬ï¼Œåœ¨ä»€ä¹ˆæ ·çš„ node ä¸Šè¿è¡Œç­‰ã€‚ä¸ºäº†æ»¡è¶³ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼Œk8s æä¾›äº†å¤šç§ç±»å‹çš„ controllerã€‚")]),e._v(" "),s("ul",[s("li",[e._v("Deployment\n"),s("ul",[s("li",[e._v("æœ€å¸¸ä½¿ç”¨ï¼Œå¯ä»¥ç®¡ç† pod å¤šä¸ªå‰¯æœ¬ï¼Œå¹¶ç¡®ä¿ pod æŒ‰ç…§æœŸæœ›çš„çŠ¶æ€è¿è¡Œï¼Œåº•å±‚è°ƒç”¨ ReplicaSetã€‚")])])]),e._v(" "),s("li",[e._v("ReplicaSet\n"),s("ul",[s("li",[e._v("å®ç° pod çš„å¤šå‰¯æœ¬ç®¡ç†ï¼Œé€šå¸¸ä½¿ç”¨ Deployment å°±å¤Ÿäº†ã€‚")])])]),e._v(" "),s("li",[e._v("DaemonSet\n"),s("ul",[s("li",[e._v("ç”¨äºæ¯ä¸ª node æœ€å¤šåªè¿è¡Œä¸€ä¸ª pod å‰¯æœ¬çš„åœºæ™¯ã€‚")]),e._v(" "),s("li",[e._v("ä½¿ç”¨åœºæ™¯\n"),s("ul",[s("li",[e._v("åœ¨é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œå­˜å‚¨ Daemonï¼Œæ¯”å¦‚ glusterd æˆ– cephã€‚")]),e._v(" "),s("li",[e._v("åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œæ—¥å¿—æœé›† Daemonï¼Œæ¯”å¦‚ flunentd æˆ– logstashã€‚")]),e._v(" "),s("li",[e._v("åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œç›‘æ§ï¼Œæ¯”å¦‚ Prometheus Node Exporter æˆ– collectedã€‚")])])])])]),e._v(" "),s("li",[e._v("StatefuleSet\n"),s("ul",[s("li",[e._v("èƒ½å¤Ÿä¿è¯ pod çš„æ¯ä¸ªå‰¯æœ¬åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­åç§°æ˜¯ä¸å˜çš„ï¼Œè€Œå…¶ä»– controller ä¸æä¾›è¿™ä¸ªåŠŸèƒ½ã€‚")])])]),e._v(" "),s("li",[e._v("Job\n"),s("ul",[s("li",[e._v("ç”¨äºè¿è¡Œç»“æŸå°±åˆ é™¤çš„åº”ç”¨ï¼Œè€Œå…¶ä»– controller ä¸­çš„ pod é€šå¸¸æ˜¯é•¿æœŸæŒç»­è¿è¡Œã€‚")])])])]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("æç¤º")]),e._v(" "),s("p",[e._v("ä½¿ç”¨ deployment controller åˆ›å»ºçš„ç”¨ä¾‹ï¼Œå¦‚æœå‡ºç°æœ‰ pod æŒ‚æ‰çš„æƒ…å†µï¼Œä¼šè‡ªåŠ¨æ–°å»ºä¸€ä¸ª podï¼Œæ¥ç»´æŒé…ç½®ä¸­çš„ pod æ•°é‡ã€‚")])]),e._v(" "),s("h4",{attrs:{id:"job"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#job"}},[e._v("#")]),e._v(" Job")]),e._v(" "),s("p",[e._v("å®¹å™¨æŒ‰ç…§æŒç»­è¿è¡Œæ—¶é—´å¯åˆ†ä¸ºä¸¤ç±»ï¼šæœåŠ¡ç±»å®¹å™¨å’Œå·¥ä½œç±»å®¹å™¨ã€‚")]),e._v(" "),s("p",[e._v("æœåŠ¡ç±»å®¹å™¨é€šå¸¸æŒç»­æä¾›æœåŠ¡ï¼Œéœ€è¦ä¸€ç›´è¿è¡Œï¼Œæ¯”å¦‚ http serverã€‚å·¥ä½œç±»å®¹å™¨åˆ™æ˜¯ä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œæ¯”å¦‚æ‰¹å¤„ç†ç¨‹åºï¼Œå®Œæˆåå®¹å™¨å°±é€€å‡ºã€‚")]),e._v(" "),s("p",[e._v("Controller ä¸­ deploymentã€replicaSet å’Œ daemonSet ç±»å‹éƒ½ç”¨äºç®¡ç†æœåŠ¡ç±»å®¹å™¨ï¼Œå¯¹äºå·¥ä½œç±»å®¹å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ jobã€‚")]),e._v(" "),s("h3",{attrs:{id:"service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#service"}},[e._v("#")]),e._v(" Service")]),e._v(" "),s("p",[e._v("Service æ˜¯å¯ä»¥è®¿é—®ä¸€ç»„ pod çš„ç­–ç•¥ï¼Œé€šå¸¸ç§°ä¸ºå¾®æœåŠ¡ã€‚å…·ä½“è®¿é—®å“ªä¸€ç»„ pod æ˜¯é€šè¿‡ label åŒ¹é…å‡ºæ¥çš„ã€‚service ä¸º pod æä¾›äº†è´Ÿè½½å‡è¡¡ï¼ŒåŸç†æ˜¯ä½¿ç”¨ iptablesã€‚")]),e._v(" "),s("p",[s("strong",[e._v("ä¸ºä»€ä¹ˆè¦ç”¨ service ï¼Ÿ")])]),e._v(" "),s("ul",[s("li",[e._v("pod æ˜¯æœ‰ç”Ÿå‘½å‘¨æœŸçš„ï¼Œå®ƒä»¬å¯ä»¥è¢«åˆ›å»ºï¼Œä¹Ÿå¯ä»¥è¢«é”€æ¯ï¼Œç„¶è€Œä¸€æ—¦è¢«é”€æ¯ç”Ÿå‘½å°±æ°¸è¿œç»“æŸã€‚è€Œ pod åœ¨ä¸€ä¸ª k8s é›†ç¾¤ä¸­å¯èƒ½ç»å¸¸æ€§çš„åˆ›å»ºï¼Œé”€æ¯ï¼Œæ¯ä¸€æ¬¡é‡å»ºéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ ip åœ°å€ã€‚")]),e._v(" "),s("li",[e._v("service ä»é€»è¾‘ä¸Šä»£è¡¨äº†ä¸€ç»„ podï¼Œå…·ä½“æ˜¯å“ªäº› pod æ˜¯ç”± label æ¥æŒ‘é€‰çš„ã€‚service æœ‰è‡ªå·±çš„ ipï¼Œè€Œä¸”è¿™ä¸ª ip æ˜¯ä¸å˜çš„ï¼Œå®¢æˆ·ç«¯åªéœ€è¦è®¿é—® service çš„ ipï¼Œk8s åˆ™è´Ÿè´£å»ºç«‹å’Œç»´æŠ¤ service ä¸ pod çš„æ˜ å°„å…³ç³»ï¼Œæ— è®º pod å¦‚ä½•å˜åŒ–ï¼Œå¯¹å®¢æˆ·ç«¯ä¸ä¼šæœ‰ä»»ä½•å½±å“ï¼Œå› ä¸º service æ²¡æœ‰å˜ã€‚")])]),e._v(" "),s("p",[s("strong",[e._v("å¤–ç½‘å¦‚ä½•è®¿é—® serviceï¼Ÿ")])]),e._v(" "),s("ul",[s("li",[e._v("ClusterIPï¼šé€šè¿‡é›†ç¾¤çš„å†…éƒ¨ ip æš´éœ²æœåŠ¡ï¼Œé€‰æ‹©è¯¥å€¼ï¼ŒæœåŠ¡åªèƒ½å¤Ÿåœ¨é›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®ï¼Œè¿™ä¹Ÿæ˜¯é»˜è®¤çš„ ServiceTypeã€‚")]),e._v(" "),s("li",[e._v("NodePortï¼šé€šè¿‡æ¯ä¸ª node ä¸Šçš„ ip å’Œç«¯å£ï¼ˆNodePortï¼‰æš´éœ²æœåŠ¡ã€‚NodePort æœåŠ¡ä¼šè·¯ç”±åˆ° ClusterIP æœåŠ¡ï¼Œè¿™ä¸ª ClusterIP æœåŠ¡ä¼šè‡ªåŠ¨åˆ›å»ºã€‚é€šè¿‡è¯·æ±‚ "),s("code",[e._v("nodeip:nodeport")]),e._v("ï¼Œå¯ä»¥ä»é›†ç¾¤çš„å¤–éƒ¨è®¿é—®ä¸€ä¸ª service æœåŠ¡ã€‚")]),e._v(" "),s("li",[e._v("LoadBalancerï¼šä½¿ç”¨äº‘æä¾›å•†çš„è´Ÿè½½å±€è¡¡å™¨ï¼Œå¯ä»¥å‘å¤–éƒ¨æš´éœ²æœåŠ¡ã€‚å¤–éƒ¨çš„è´Ÿè½½å‡è¡¡å™¨å¯ä»¥è·¯ç”±åˆ° NodePort æœåŠ¡å’Œ ClusterIP æœåŠ¡ã€‚")]),e._v(" "),s("li",[e._v("ExternalNameï¼šé€šè¿‡è¿”å› CNAME å’Œå®ƒçš„å€¼ï¼Œå¯ä»¥å°†æœåŠ¡æ˜ å°„åˆ° externalName å­—æ®µçš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œ foo.bar.example.comï¼‰ã€‚ æ²¡æœ‰ä»»ä½•ç±»å‹ä»£ç†è¢«åˆ›å»ºï¼Œè¿™åªæœ‰ k8s 1.7 æˆ–æ›´é«˜ç‰ˆæœ¬çš„ kube-dns æ‰æ”¯æŒã€‚")])]),e._v(" "),s("h3",{attrs:{id:"namespace"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#namespace"}},[e._v("#")]),e._v(" Namespace")]),e._v(" "),s("p",[e._v("å¦‚æœæœ‰å¤šä¸ªç”¨æˆ·ä½¿ç”¨åŒä¸€ä¸ª k8s clusterï¼Œå¦‚ä½•å°†ä»–ä»¬åˆ›å»ºçš„ controllerï¼Œpod ç­‰èµ„æºåˆ†å¼€å‘¢ï¼Ÿ")]),e._v(" "),s("p",[e._v("ç­”ï¼šä½¿ç”¨ namespaceã€‚")]),e._v(" "),s("p",[e._v("å¦‚æœå°†ç‰©ç†çš„ cluster é€»è¾‘ä¸Šåˆ’åˆ†æˆå¤šä¸ªè™šæ‹Ÿ clusterï¼Œæ¯ä¸ª cluster å°±æ˜¯ä¸€ä¸ª namespaceï¼Œä¸åŒ namespace é‡Œçš„èµ„æºæ˜¯å®Œå…¨éš”ç¦»çš„ã€‚")]),e._v(" "),s("p",[e._v("k8s é»˜è®¤åˆ›å»ºäº†ä¸¤ä¸ª namespaceã€‚")]),e._v(" "),s("ul",[s("li",[e._v("default åˆ›å»ºèµ„æºæ—¶å¦‚æœä¸æŒ‡å®šï¼Œå°†ä¼šæ”¾åˆ°è¿™ä¸ª namespace ä¸­ã€‚")]),e._v(" "),s("li",[e._v("kube-system å­˜æ”¾ k8s è‡ªå·±åˆ›å»ºçš„ç³»ç»Ÿèµ„æºã€‚")])]),e._v(" "),s("h2",{attrs:{id:"kubernetes-ä¼˜åŒ–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-ä¼˜åŒ–"}},[e._v("#")]),e._v(" Kubernetes ä¼˜åŒ–")]),e._v(" "),s("ul",[s("li",[e._v("å¥åº·æ£€æŸ¥")]),e._v(" "),s("li",[e._v("æ•°æ®ç®¡ç†")]),e._v(" "),s("li",[e._v("å¯†ç ç®¡ç†")]),e._v(" "),s("li",[e._v("é›†ç¾¤ç›‘æ§")])]),e._v(" "),s("h3",{attrs:{id:"å¥åº·æ£€æŸ¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¥åº·æ£€æŸ¥"}},[e._v("#")]),e._v(" å¥åº·æ£€æŸ¥")]),e._v(" "),s("p",[e._v("å¼ºå¤§çš„è‡ªæ„ˆèƒ½åŠ›æ˜¯ k8s è¿™ç±»å®¹å™¨ç¼–æ’å¼•æ“çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ã€‚è‡ªæ„ˆçš„é»˜è®¤å®ç°æ–¹å¼æ˜¯è‡ªåŠ¨é‡å¯å‘ç”Ÿæ•…éšœçš„å®¹å™¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥åˆ©ç”¨ liveness å’Œ readiness æ¢æµ‹æœºåˆ¶è®¾ç½®æ›´ç²¾ç»†çš„å¥åº·æ£€æŸ¥ï¼Œè¿›è€Œå®ç°å¦‚ä¸‹éœ€æ±‚ï¼š")]),e._v(" "),s("ul",[s("li",[e._v("é›¶åœæœºéƒ¨ç½²")]),e._v(" "),s("li",[e._v("é¿å…éƒ¨ç½²æ— æ•ˆçš„é•œåƒ")]),e._v(" "),s("li",[e._v("æ›´åŠ å®‰å…¨çš„æ»šåŠ¨å‡çº§")])]),e._v(" "),s("p",[e._v("é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰å®¹å™¨è¿›ç¨‹è¿”å›å€¼éé›¶ï¼Œk8s æ‰ä¼šè®¤ä¸ºå®¹å™¨å‘ç”Ÿäº†æ•…éšœï¼Œéœ€è¦é‡å¯ã€‚å¦‚æœæˆ‘ä»¬æƒ³æ›´åŠ ç»†ç²’åº¦çš„æ§åˆ¶å®¹å™¨é‡å¯ï¼Œå¯ä»¥ä½¿ç”¨ liveness å’Œ readinessã€‚")]),e._v(" "),s("p",[e._v("liveness å’Œ readiness çš„åŸç†æ˜¯å®šæœŸæ£€æŸ¥ "),s("code",[e._v("/tmp/healthy")]),e._v(" æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å³è®¤ä¸ºç¨‹åºæ²¡æœ‰å‡ºæ•…éšœï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šé‡‡å–ç›¸åº”çš„æªæ–½æ¥è¿›è¡Œåé¦ˆã€‚")]),e._v(" "),s("p",[e._v("liveness é‡‡å–çš„ç­–ç•¥æ˜¯é‡å¯å®¹å™¨ï¼Œè€Œ readiness é‡‡å–çš„ç­–ç•¥æ˜¯å°†å®¹å™¨è®¾ç½®ä¸ºä¸å¯ç”¨ã€‚")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),s("p",[e._v("å¦‚æœéœ€è¦åœ¨ç‰¹å®šæƒ…å†µä¸‹é‡å¯å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ livenessã€‚")]),e._v(" "),s("p",[e._v("å¦‚æœéœ€è¦ä¿è¯å®¹å™¨ä¸€ç›´å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ readinessã€‚")])]),e._v(" "),s("p",[e._v("æˆ‘ä»¬å¯ä»¥å°† liveness å’Œ readiness é…åˆä½¿ç”¨ï¼Œä½¿ç”¨ liveness åˆ¤æ–­å®¹å™¨æ˜¯å¦éœ€è¦é‡å¯ï¼Œç”¨ readiness åˆ¤æ–­å®¹å™¨æ˜¯å¦å·²ç»å‡†å¤‡å¥½å¯¹å¤–æä¾›æœåŠ¡ã€‚")]),e._v(" "),s("h3",{attrs:{id:"æ•°æ®ç®¡ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®ç®¡ç†"}},[e._v("#")]),e._v(" æ•°æ®ç®¡ç†")]),e._v(" "),s("p",[e._v("ä¸Šæ–‡è¯´é“ï¼Œpod å¯èƒ½ä¼šè¢«é¢‘ç¹åœ°é”€æ¯å’Œåˆ›å»ºï¼Œå½“å®¹å™¨é”€æ¯æ—¶ï¼Œä¿å­˜åœ¨å®¹å™¨å†…éƒ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ•°æ®éƒ½ä¼šè¢«æ¸…é™¤ã€‚ä¸ºäº†æŒä¹…åŒ–ä¿å­˜å®¹å™¨çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ k8s volumeã€‚")]),e._v(" "),s("p",[e._v("Volume çš„ç”Ÿå‘½å‘¨æœŸç‹¬ç«‹äºå®¹å™¨ï¼Œpod ä¸­çš„å®¹å™¨å¯èƒ½è¢«é”€æ¯å’Œé‡å»ºï¼Œä½† volume ä¼šè¢«ä¿ç•™ã€‚å®è´¨ä¸Š vloume æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå½“ volume è¢« mount åˆ° podï¼Œpod ä¸­çš„æ‰€æœ‰å®¹å™¨éƒ½å¯ä»¥è®¿é—®åˆ°è¿™ä¸ª volumeã€‚")]),e._v(" "),s("p",[e._v("Volume æ”¯æŒå¤šç§ç±»å‹ã€‚")]),e._v(" "),s("ul",[s("li",[e._v("emptyDir\n"),s("ul",[s("li",[e._v("æ•°æ®å­˜æ”¾åœ¨ pod ä¸­ï¼Œå¯¹ pod ä¸­çš„å®¹å™¨æ¥è¯´ï¼Œæ˜¯æŒä¹…çš„ï¼Œåªè¦ pod è¿˜åœ¨æ•°æ®å°±è¿˜åœ¨ã€‚")])])]),e._v(" "),s("li",[e._v("hostPath\n"),s("ul",[s("li",[e._v("æ•°æ®å­˜åœ¨ä¸»æœºä¸Šï¼Œä¸»æœºåœ¨æ•°æ®å°±åœ¨ã€‚")])])]),e._v(" "),s("li",[e._v("AWS Elastic Block Store\n"),s("ul",[s("li",[e._v("æ•°æ®å­˜åœ¨äº‘æœåŠ¡å™¨ä¸Šã€‚")])])]),e._v(" "),s("li",[e._v("Persistent Volume\n"),s("ul",[s("li",[e._v("è‡ªå®šä¹‰ä¸€å—å¤–éƒ¨å­˜å‚¨ç©ºé—´ Persistent Volumeï¼Œç„¶ååœ¨åˆ›å»º pod æ—¶ä½¿ç”¨ PersistentVolumeClaimï¼ˆPVCï¼‰å»ç”³è¯·ç©ºé—´ï¼Œå¹¶è¿›è¡Œå­˜å‚¨ã€‚")])])])]),e._v(" "),s("p",[e._v("Volume æä¾›äº†å¯¹å„ç§ç±»å‹çš„å­˜æ”¾æ–¹å¼ï¼Œä½†å®¹å™¨åœ¨ä½¿ç”¨ volume è¯»å†™æ•°æ®æ—¶ï¼Œä¸éœ€è¦å…³å¿ƒæ•°æ®åˆ°åº•æ˜¯å­˜æ”¾åœ¨æœ¬åœ°èŠ‚ç‚¹çš„ç³»ç»Ÿä¸­è¿˜æ˜¯äº‘ç¡¬ç›˜ä¸Šã€‚å¯¹å®¹å™¨æ¥è¯´ï¼Œæ‰€æœ‰ç±»å‹çš„ volume éƒ½åªæ˜¯ä¸€ä¸ªç›®å½•ã€‚")]),e._v(" "),s("h3",{attrs:{id:"å¯†ç ç®¡ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¯†ç ç®¡ç†"}},[e._v("#")]),e._v(" å¯†ç ç®¡ç†")]),e._v(" "),s("p",[e._v("åº”ç”¨ç¨‹åºåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚è®¿é—®æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç ã€‚å°†è¿™äº›ä¿¡æ¯ç›´æ¥ä¿å­˜åœ¨å®¹å™¨é•œåƒä¸­æ˜¾ç„¶ä¸å¦¥ï¼Œk8s æä¾›çš„è§£å†³æ–¹æ¡ˆæ˜¯ secretã€‚")]),e._v(" "),s("p",[e._v("secret ä¼šä»¥å¯†æ–‡çš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œé¿å…ç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿å­˜æ•æ„Ÿä¿¡æ¯ã€‚secret ä¼šä»¥ volume çš„å½¢å¼è¢« mount åˆ° podï¼Œå®¹å™¨å¯é€šè¿‡æ–‡ä»¶çš„æ–¹å¼ä½¿ç”¨ secret ä¸­çš„æ•æ„Ÿæ•°æ®ï¼Œæ­¤å¤–å®¹å™¨ä¹Ÿå¯ä»¥æŒ‰ç¯å¢ƒå˜é‡çš„å½¢å¼ä½¿ç”¨è¿™äº›æ•°æ®ã€‚")]),e._v(" "),s("p",[e._v("ä½¿ç”¨é…ç½®æ–‡ä»¶åˆ›å»º mysecret.yamlï¼š")]),e._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\nkind Secret\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("mysecret\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  username"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("admin\n  password"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("123")]),e._v("\n")])])]),s("p",[e._v("ä¿å­˜é…ç½®æ–‡ä»¶åï¼Œç„¶åæ‰§è¡Œ"),s("code",[e._v("kubectl apply -f mysecret.yaml")]),e._v("è¿›è¡Œåˆ›å»ºã€‚")]),e._v(" "),s("p",[e._v("åœ¨ pod ä¸­ä½¿ç”¨åˆ›å»ºå¥½çš„ secretï¼š")]),e._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# mypod.yaml")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Pod\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mypod\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mypod\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" lmjben/notepad\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("volumeMounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" foo\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("mountPath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'etc/foo'")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("readOnly")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" foo\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("secret")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("secretName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mysecret\n")])])]),s("p",[e._v("æ‰§è¡Œ"),s("code",[e._v("kubectl apply -f mypod.yaml")]),e._v(" åˆ›å»º podï¼Œå¹¶ä½¿ç”¨ secretã€‚åˆ›å»ºå®Œæˆåï¼Œsecret ä¿å­˜åœ¨å®¹å™¨å†… /etc/foo/username ï¼Œ/etc/foo/password ç›®å½•ä¸‹ã€‚")]),e._v(" "),s("h3",{attrs:{id:"é›†ç¾¤ç›‘æ§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é›†ç¾¤ç›‘æ§"}},[e._v("#")]),e._v(" é›†ç¾¤ç›‘æ§")]),e._v(" "),s("p",[e._v("åˆ›å»º k8s é›†ç¾¤å¹¶éƒ¨ç½²å®¹å™¨åŒ–åº”ç”¨åªæ˜¯ç¬¬ä¸€æ­¥ã€‚ä¸€æ—¦é›†ç¾¤è¿è¡Œèµ·æ¥ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿é›†ç¾¤ä¸€åˆ‡éƒ½æ˜¯æ­£å¸¸çš„ï¼Œè¿™å°±éœ€è¦å¯¹é›†ç¾¤è¿›è¡Œç›‘æ§ã€‚")]),e._v(" "),s("p",[e._v("å¸¸ç”¨çš„å¯è§†åŒ–ç›‘æ§å·¥å…·å¦‚ä¸‹ã€‚")]),e._v(" "),s("ul",[s("li",[e._v("Weave Scope")]),e._v(" "),s("li",[e._v("Heapster")]),e._v(" "),s("li",[e._v("Prometheus Operator")])]),e._v(" "),s("p",[e._v("å…·ä½“çš„ä½¿ç”¨æ­¥éª¤å°±ç›´æ¥çœ‹æ–‡æ¡£äº†ï¼Œè¿™é‡Œä¸è¯¦ç»†è¯´æ˜ã€‚")]),e._v(" "),s("p",[e._v("é€šè¿‡é›†ç¾¤ç›‘æ§æˆ‘ä»¬èƒ½å¤ŸåŠæ—¶å‘ç°é›†ç¾¤å‡ºç°çš„é—®é¢˜ï¼Œä½†ä¸ºäº†æ–¹ä¾¿è¿›ä¸€æ­¥æ’æŸ¥é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œè¿›è¡Œæ—¥å¿—è®°å½•ã€‚")]),e._v(" "),s("p",[e._v("å¸¸ç”¨çš„æ—¥å¿—ç®¡ç†å·¥å…·å¦‚ä¸‹ã€‚")]),e._v(" "),s("ul",[s("li",[e._v("Elasticsearch è´Ÿè´£å­˜å‚¨æ—¥å¿—å¹¶æä¾›æŸ¥è¯¢æ¥å£ã€‚")]),e._v(" "),s("li",[e._v("Fluentd è´Ÿè´£ä» k8s æœé›†æ—¥å¿—å¹¶å‘é€ç»™ Elasticsearchã€‚")]),e._v(" "),s("li",[e._v("Kibana æä¾›ä¸€ä¸ªå¯è§†åŒ–é¡µé¢ï¼Œç”¨æˆ·å¯ä»¥æµè§ˆå’Œæœç´¢æ—¥å¿—ã€‚")])]),e._v(" "),s("h2",{attrs:{id:"kubernetes-å®æˆ˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-å®æˆ˜"}},[e._v("#")]),e._v(" Kubernetes å®æˆ˜")]),e._v(" "),s("p",[e._v("æˆ‘ä»¬æ¥å®æˆ˜éƒ¨ç½²ä¸€ä¸ª k8s è®°äº‹æœ¬é¡¹ç›®ï¼Œé¡¹ç›®ä½¿ç”¨ "),s("a",{attrs:{href:"https://cloud.docker.com/u/lmjben/repository/docker/lmjben/notepad",target:"_blank",rel:"noopener noreferrer"}},[e._v("lmjben/notepad"),s("OutboundLink")],1),e._v(" é•œåƒè¿›è¡Œæ„å»ºï¼Œè¯¥é•œåƒåœ¨éƒ¨ç½²åä¼šåœ¨ 8083 ç«¯å£ä¸Šæä¾›ä¸€ä¸ª web ç‰ˆè®°äº‹æœ¬æœåŠ¡ï¼Œ"),s("a",{attrs:{href:"http://yinhengli.com:8083/",target:"_blank",rel:"noopener noreferrer"}},[e._v("æŸ¥çœ‹æ¼”ç¤º"),s("OutboundLink")],1),e._v("ã€‚")]),e._v(" "),s("p",[e._v("ä¸ºäº†é¿å…å®‰è£… k8s å‡ºç°çš„å„ç§å‘ï¼Œè¿™é‡Œä½¿ç”¨ "),s("a",{attrs:{href:"https://labs.play-with-k8s.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Play with Kubernetes"),s("OutboundLink")],1),e._v("è¿›è¡Œæ¼”ç¤ºã€‚")]),e._v(" "),s("p",[e._v("é¦–å…ˆåœ¨ Play with Kubernetes ä¸Šåˆ›å»º 3 å°æœåŠ¡å™¨ï¼Œnode1 ä½œä¸º master èŠ‚ç‚¹ï¼Œnode2 å’Œ node3 ä½œä¸ºå·¥ä½œèŠ‚ç‚¹ã€‚æ¥ä¸‹æ¥è¿›è¡Œä»¥ä¸‹æ“ä½œï¼›")]),e._v(" "),s("ul",[s("li",[e._v("åˆ›å»ºä¸€ä¸ªé›†ç¾¤ cluster")]),e._v(" "),s("li",[e._v("åŠ å…¥ node èŠ‚ç‚¹")]),e._v(" "),s("li",[e._v("åˆå§‹åŒ– cluster ç½‘ç»œ")]),e._v(" "),s("li",[e._v("åˆ›å»º controller")]),e._v(" "),s("li",[e._v("åˆ›å»º service")]),e._v(" "),s("li",[e._v("æ‰§è¡Œéƒ¨ç½²")])]),e._v(" "),s("h3",{attrs:{id:"åˆ›å»ºä¸€ä¸ªé›†ç¾¤-cluster"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºä¸€ä¸ªé›†ç¾¤-cluster"}},[e._v("#")]),e._v(" åˆ›å»ºä¸€ä¸ªé›†ç¾¤ cluster")]),e._v(" "),s("p",[e._v("åœ¨ node1 ä¸Šè¿è¡Œ kubeadm init å³å¯åˆ›å»ºä¸€ä¸ªé›†ç¾¤ã€‚")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubeadm init --apiserver-advertise-address "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("hostname")]),e._v(" -i"),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v("\n")])])]),s("p",[e._v("æ‰§è¡Œå®Œæˆåä¼šç”Ÿæˆ tokenï¼Œè¿™æ ·å…¶ä»–èŠ‚ç‚¹å°±å¯ä»¥å‡­å€Ÿè¿™ä¸ª token åŠ å…¥è¯¥é›†ç¾¤ã€‚")]),e._v(" "),s("p",[s("img",{attrs:{src:"devops-kubernetes-step1.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤1"}})]),e._v(" "),s("h3",{attrs:{id:"åŠ å…¥-node-èŠ‚ç‚¹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŠ å…¥-node-èŠ‚ç‚¹"}},[e._v("#")]),e._v(" åŠ å…¥ node èŠ‚ç‚¹")]),e._v(" "),s("p",[e._v("åœ¨ node2 å’Œ node3 æœºå™¨ä¸Šï¼Œåˆ†åˆ«æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒåŠ å…¥åˆ° node1 çš„é›†ç¾¤ã€‚")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubeadm "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("join")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".0.8:6443 --token nfs9d0.z7ibv3xokif1mnmv "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    --discovery-token-ca-cert-hash sha256:6587f474ae1543b38954b0e560832ff5b7c67f79e1d464e7f59e33b0fefd6548\n")])])]),s("p",[e._v("å‘½ä»¤æ‰§è¡Œå®Œæ¯•åï¼Œå³å¯çœ‹åˆ° node2ï¼Œnode3 å·²ç»åŠ å…¥æˆåŠŸã€‚")]),e._v(" "),s("p",[s("img",{attrs:{src:"devops-kubernetes-step2.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤2"}})]),e._v(" "),s("h3",{attrs:{id:"æŸ¥çœ‹é›†ç¾¤çŠ¶æ€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æŸ¥çœ‹é›†ç¾¤çŠ¶æ€"}},[e._v("#")]),e._v(" æŸ¥çœ‹é›†ç¾¤çŠ¶æ€")]),e._v(" "),s("p",[e._v("åœ¨ node1 èŠ‚ç‚¹ä¸Šï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl get node\n")])])]),s("p",[s("img",{attrs:{src:"devops-kubernetes-step3.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤3"}})]),e._v(" "),s("p",[e._v("å¯ä»¥çœ‹åˆ°ï¼Œé›†ç¾¤ä¸­å­˜åœ¨ node1 ï¼Œnode2ï¼Œnode3 è¿™ 3 ä¸ªèŠ‚ç‚¹ï¼Œä½†è¿™ 3 ä¸ªèŠ‚ç‚¹çš„éƒ½æ˜¯ NotReady çŠ¶æ€ï¼Œä¸ºä»€ä¹ˆï¼Ÿ")]),e._v(" "),s("p",[e._v("ç­”ï¼šå› ä¸ºæ²¡æœ‰åˆ›å»ºé›†ç¾¤ç½‘ç»œã€‚")]),e._v(" "),s("h3",{attrs:{id:"åˆ›å»ºé›†ç¾¤ç½‘ç»œ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºé›†ç¾¤ç½‘ç»œ"}},[e._v("#")]),e._v(" åˆ›å»ºé›†ç¾¤ç½‘ç»œ")]),e._v(" "),s("p",[e._v("æ‰§è¡Œä»¥ä¸‹ä»£ç åˆ›å»ºé›†ç¾¤ç½‘ç»œã€‚")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl apply -n kube-system -f "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://cloud.weave.works/k8s/net?k8s-version='),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("kubectl version "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" base64 "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("tr")]),e._v(" -d "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'"),s("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[e._v("\\n")]),e._v("'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v('"')]),e._v("\n")])])]),s("p",[e._v("æ‰§è¡Œå‘½ä»¤åï¼Œç¨ç­‰ä¸€ä¸‹ï¼Œç„¶åæŸ¥çœ‹ node çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œé›†ç¾¤ä¸­çš„ 3 ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ Ready çŠ¶æ€äº†ã€‚")]),e._v(" "),s("p",[s("img",{attrs:{src:"devops-kubernetes-step4.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤4"}})]),e._v(" "),s("h3",{attrs:{id:"åˆ›å»º-deployment"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-deployment"}},[e._v("#")]),e._v(" åˆ›å»º Deployment")]),e._v(" "),s("p",[e._v("æˆ‘ä»¬é€šè¿‡é…ç½®æ–‡ä»¶æ¥åˆ›å»º deploymentï¼Œæ–°å»º deployment.yaml æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),e._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# é…ç½®æ–‡ä»¶æ ¼å¼çš„ç‰ˆæœ¬")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" apps/v1\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åˆ›å»ºçš„èµ„æºç±»å‹")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Deployment\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# èµ„æºçš„å…ƒæ•°æ®")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" notepad\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# è§„æ ¼è¯´æ˜")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å®šä¹‰ pod æ•°é‡")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("replicas")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# é€šè¿‡ label æ‰¾åˆ°å¯¹åº”çš„ pod")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("matchLabels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mytest\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å®šä¹‰ pod çš„æ¨¡æ¿")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# pod çš„å…ƒæ•°æ®")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å®šä¹‰ pod çš„ label")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mytest\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æè¿° pod çš„è§„æ ¼")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" notepad\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" lmjben/notepad\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("containerPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8083")]),e._v("\n")])])]),s("p",[e._v("æ–‡ä»¶åˆ›å»ºä¹‹åï¼Œæ‰§è¡Œå‘½ä»¤ï¼š")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl apply -f ./deployment.yaml\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# deployment.apps/notepad created")]),e._v("\n")])])]),s("p",[e._v("æŸ¥çœ‹éƒ¨ç½²çš„ podã€‚")]),e._v(" "),s("p",[s("img",{attrs:{src:"devops-kubernetes-step4.1.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤4.1"}})]),e._v(" "),s("p",[e._v("å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨ deployment ç±»å‹çš„ controller åˆ›å»ºäº† 3 ä¸ª podï¼Œåˆ†åˆ«è¿è¡Œåœ¨ node2 å’Œ node3 æœºå™¨ä¸Šï¼Œå¦‚æœæœ‰æ›´å¤šçš„æœºå™¨ï¼Œä¹Ÿä¼šè‡ªåŠ¨è´Ÿè½½å‡è¡¡ï¼Œåˆç†åœ°åˆ†é…åˆ°æ¯ä¸ªæœºå™¨ä¸Šã€‚")]),e._v(" "),s("h3",{attrs:{id:"åˆ›å»º-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-service"}},[e._v("#")]),e._v(" åˆ›å»º Service")]),e._v(" "),s("p",[e._v("åˆ›å»º service å’Œ deployment ç±»ä¼¼ï¼Œæ–°å»º service.yaml æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),e._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Service\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("service\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åœ¨èŠ‚ç‚¹ä¸Šéƒ¨ç½²è®¿é—® pod çš„ç«¯å£")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" NodePort\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# service ä»£ç†çš„ç«¯å£")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("targetPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8083")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# node èŠ‚ç‚¹ä¸Šæä¾›ç»™é›†ç¾¤å¤–éƒ¨çš„è®¿é—®ç«¯å£")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("nodePort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("30036")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åŒ¹é… pod")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mytest\n")])])]),s("p",[e._v("æ–‡ä»¶åˆ›å»ºä¹‹åï¼Œæ‰§è¡Œå‘½ä»¤ï¼š")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl apply -f ./service.yaml\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# service/my-service created")]),e._v("\n")])])]),s("h3",{attrs:{id:"æŸ¥çœ‹åˆ›å»ºç»“æœ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æŸ¥çœ‹åˆ›å»ºç»“æœ"}},[e._v("#")]),e._v(" æŸ¥çœ‹åˆ›å»ºç»“æœ")]),e._v(" "),s("p",[e._v("ä½¿ç”¨ kubectl get deployment å’Œ kubectl get service æŸ¥çœ‹åˆ›å»ºç»“æœã€‚")]),e._v(" "),s("p",[s("img",{attrs:{src:"devops-kubernetes-step5.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤5"}})]),e._v(" "),s("p",[e._v("å¯ä»¥çœ‹åˆ°ï¼Œdeployment å’Œ service å‡åˆ›å»ºæˆåŠŸï¼Œå¹¶ä¸”å·²çŸ¥ service æš´éœ²çš„ ip åœ°å€ä¸ºï¼š10.106.74.65ï¼Œç«¯å£å·ä¸º 80ï¼Œç”±äºè®¾ç½®äº† targetPortï¼Œservice åœ¨æ¥æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œä¼šè‡ªåŠ¨è½¬å‘åˆ° pod å¯¹åº”çš„ 8083 ç«¯å£ä¸Šã€‚")]),e._v(" "),s("h3",{attrs:{id:"è®¿é—®éƒ¨ç½²ç»“æœ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è®¿é—®éƒ¨ç½²ç»“æœ"}},[e._v("#")]),e._v(" è®¿é—®éƒ¨ç½²ç»“æœ")]),e._v(" "),s("p",[e._v("éƒ¨ç½²æˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼è¿›è¡Œè®¿é—®ï¼š")]),e._v(" "),s("ul",[s("li",[e._v("é›†ç¾¤å†…ï¼šé€šè¿‡ service çš„ clusterIp + port ç«¯å£è¿›è¡Œè®¿é—®ã€‚")]),e._v(" "),s("li",[e._v("é›†ç¾¤å¤–ï¼šé€šè¿‡ä»»æ„ä¸€ä¸ª node èŠ‚ç‚¹ + nodePort ç«¯å£è¿›è¡Œè®¿é—®ã€‚")])]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# é›†ç¾¤å†…è®¿é—®")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.106")]),e._v(".74.65\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# é›†ç¾¤å¤–è®¿é—®")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 192.168.0.12 æ˜¯ node2 èŠ‚ç‚¹çš„ip")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 192.168.0.11 æ˜¯ node3 èŠ‚ç‚¹çš„ip")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".0.12:30036\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".0.11:30036\n")])])]),s("p",[e._v("é›†ç¾¤å†…è®¿é—®ã€‚")]),e._v(" "),s("p",[s("img",{attrs:{src:"devops-kubernetes-step6.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤6"}})]),e._v(" "),s("p",[e._v("é›†ç¾¤å¤–è®¿é—®ã€‚")]),e._v(" "),s("p",[s("img",{attrs:{src:"devops-kubernetes-step7.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤6"}})]),e._v(" "),s("p",[e._v("åˆ°è¿™é‡Œï¼Œå·²ç»ç®—éƒ¨ç½²æˆåŠŸäº†ï¼Œå¤§å®¶è‚¯å®šæœ‰ç–‘é—®ï¼Œéƒ¨ç½²ä¸€ä¸ªå¦‚æ­¤ç®€å•çš„ web åº”ç”¨å°±è¿™ä¹ˆéº»çƒ¦ï¼Œåˆ°åº• k8s å¥½åœ¨å“ªé‡Œï¼Ÿæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ã€‚")]),e._v(" "),s("h3",{attrs:{id:"k8s-è¿ç»´"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#k8s-è¿ç»´"}},[e._v("#")]),e._v(" K8s è¿ç»´")]),e._v(" "),s("p",[e._v("é¡¹ç›®å·²ç»éƒ¨ç½²ï¼Œæ¥ä¸‹æ¥æ¥å®æˆ˜ä¸€ä¸ªè¿ç»´ï¼Œæ„Ÿå—ä¸€ä¸‹ k8s å¸¦ç»™æˆ‘ä»¬çš„ä¾¿åˆ©ã€‚")]),e._v(" "),s("h4",{attrs:{id:"æ¡ˆä¾‹-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ¡ˆä¾‹-1"}},[e._v("#")]),e._v(" æ¡ˆä¾‹ 1")]),e._v(" "),s("p",[e._v("å…¬å¸è¦åšåŒ 11 æ´»åŠ¨ï¼Œéœ€è¦è‡³å°‘ 100 ä¸ªå®¹å™¨æ‰èƒ½æ»¡è¶³ç”¨æˆ·è¦æ±‚ï¼Œåº”è¯¥æ€ä¹ˆåšï¼Ÿ")]),e._v(" "),s("p",[e._v("é¦–å…ˆï¼Œåº”è¯¥å°½å¯èƒ½åˆ©ç”¨å½“å‰æ‹¥æœ‰çš„æœåŠ¡å™¨èµ„æºï¼Œåˆ›å»ºæ›´å¤šçš„å®¹å™¨æ¥å‚ä¸è´Ÿè½½å‡è¡¡ï¼Œé€šè¿‡ docker stats å¯ä»¥æŸ¥çœ‹å®¹å™¨å ç”¨çš„ç³»ç»Ÿèµ„æºæƒ…å†µã€‚å¦‚æœå……åˆ†åˆ©ç”¨åä»ç„¶ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œå°±æ ¹æ®å‰©ä½™éœ€è¦çš„å®¹å™¨ï¼Œè®¡ç®—å‡ºéœ€è¦è´­ä¹°å¤šå°‘æœºå™¨ï¼Œå®ç°èµ„æºçš„åˆç†åˆ©ç”¨ã€‚")]),e._v(" "),s("ul",[s("li",[e._v("è´­ä¹°æœåŠ¡å™¨ï¼Œå°†æœåŠ¡å™¨ä½œä¸º node èŠ‚ç‚¹ï¼Œjoin åˆ°é›†ç¾¤ä¸­ã€‚")]),e._v(" "),s("li",[e._v("æ‰§è¡Œæ‰©å®¹å‘½ä»¤ã€‚")])]),e._v(" "),s("p",[e._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°±èƒ½å°†å®¹å™¨æ‰©å±•åˆ° 100 ä¸ªã€‚")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl scale deployments/notepad --replicas"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("\n")])])]),s("p",[e._v("å¦‚å›¾ï¼Œæ‰©å±• 10 ä¸ª pod çš„æƒ…å†µï¼Œnode2 å’Œ node3 èŠ‚ç‚¹å…±åŒåˆ†æ‹…è´Ÿè½½ã€‚")]),e._v(" "),s("p",[s("img",{attrs:{src:"devops-kubernetes-step8.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤8"}})]),e._v(" "),s("p",[e._v("ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹ deployment.yaml ä¸­çš„ replicas å­—æ®µï¼Œæ‰§è¡Œ "),s("code",[e._v("kubectl apply -f deployment.yaml")]),e._v("å»æ‰§è¡Œæ‰©å±•ã€‚å¦‚æœæ´»åŠ¨ç»“æŸäº†ï¼Œåªéœ€è¦å°†å¤šä½™çš„æœåŠ¡å™¨åˆ é™¤ï¼Œç¼©å‡å®¹å™¨æ•°é‡å³å¯è¿˜åŸåˆ°ä¹‹å‰çš„æ•ˆæœã€‚")]),e._v(" "),s("h4",{attrs:{id:"æ¡ˆä¾‹-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ¡ˆä¾‹-2"}},[e._v("#")]),e._v(" æ¡ˆä¾‹ 2")]),e._v(" "),s("p",[e._v("åŒ 11 æ´»åŠ¨å¾ˆç«çˆ†ï¼Œä½†çªç„¶åŠ äº†éœ€æ±‚ï¼Œéœ€è¦ç´§æ€¥ä¸Šçº¿ï¼Œå¦‚æœå®ç°æ»šåŠ¨æ›´æ–°ï¼Ÿ")]),e._v(" "),s("p",[e._v("æ»šåŠ¨æ›´æ–°å°±æ˜¯åœ¨ä¸å®•æœºçš„æƒ…å†µä¸‹ï¼Œå®ç°ä»£ç æ›´æ–°ã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä¿®æ”¹ image å³å¯ã€‚")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("set")]),e._v(" image deployments/notepad "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("notepad")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("lmjben/notepad:new\n")])])]),s("p",[e._v("ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹ deployment.yaml ä¸­çš„ image å­—æ®µï¼Œæ‰§è¡Œ "),s("code",[e._v("kubectl apply -f deployment.yaml")]),e._v("å»æ‰§è¡Œå‡çº§ã€‚")]),e._v(" "),s("p",[e._v("å¦‚æœæ›´æ–°å‡ºäº†é—®é¢˜ï¼Œk8s å†…ç½®äº†ä¸€é”®è¿˜åŸä¸Šä¸ªç‰ˆæœ¬çš„å‘½ä»¤ï¼š")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("kubectl rollout undo deployments/notepad\n")])])]),s("p",[e._v("é€šè¿‡è¿™ 2 ä¸ªæ¡ˆä¾‹ï¼Œæ„Ÿè§‰åˆ°äº† k8s ç»™è¿ç»´å¸¦æ¥äº†å¾ˆå¤§çš„ä¾¿åˆ©ï¼š"),s("strong",[e._v("å¿«é€Ÿé«˜æ•ˆåœ°éƒ¨ç½²é¡¹ç›®")]),e._v("ï¼Œ"),s("strong",[e._v("æ”¯æŒåŠ¨æ€æ‰©å±•")]),e._v("ã€"),s("strong",[e._v("æ»šåŠ¨å‡çº§")]),e._v("ï¼Œ"),s("strong",[e._v("åŒæ—¶è¿˜èƒ½æŒ‰éœ€ä¼˜åŒ–ä½¿ç”¨çš„ç¡¬ä»¶èµ„æº")]),e._v("ã€‚")]),e._v(" "),s("h2",{attrs:{id:"æ€»ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[e._v("#")]),e._v(" æ€»ç»“")]),e._v(" "),s("p",[e._v("æœ¬æ–‡çš„ç›®çš„å°±æ˜¯å…¥é—¨ k8sï¼Œé€šè¿‡ä¸€ä¸ªç®€å•çš„é›†ç¾¤æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œä½†å…¶ä¸­ä¹Ÿè¸©äº†å¥½å¤šå‘ï¼Œå…·ä½“å¦‚ä¸‹ï¼š")]),e._v(" "),s("ul",[s("li",[e._v("ä½¿ç”¨ minikube æ­å»ºé¡¹ç›®\n"),s("ul",[s("li",[e._v("èƒ½å¿«é€Ÿæ­å»ºä¸€ä¸ªå•èŠ‚ç‚¹ k8s ç¯å¢ƒã€‚")]),e._v(" "),s("li",[e._v("ä½†åœ¨æœ¬åœ°ä½¿ç”¨ minikube æ­å»ºä¸€å¥— k8s é›†ç¾¤ï¼Œå¾ˆå¤šåŒ…è£…ä¸ä¸Šï¼Œå…¨å±€ä»£ç†ä¹Ÿä¸è¡Œã€‚")])])]),e._v(" "),s("li",[e._v("ä½¿ç”¨ google clould ä¸Šçš„æœåŠ¡å™¨\n"),s("ul",[s("li",[e._v("åœ¨ gogole clould ä¸Šï¼Œè§£å†³äº†ç½‘ç»œé—®é¢˜ï¼Œéœ€è¦å®‰è£…çš„åŒ…éƒ½èƒ½è£…ä¸Šã€‚")]),e._v(" "),s("li",[e._v("ä½†ç”±äºæ˜¯æ–°æœåŠ¡å™¨ï¼Œéœ€è¦å„ç§å®‰è£…ç¯å¢ƒï¼Œdockerï¼Œkubeadmï¼Œkubectl ç­‰ï¼Œå®‰è£…è¿‡ç¨‹ç¹çï¼Œè¿˜å¯èƒ½ä¼šé‡åˆ°æŠ¥é”™ã€‚")]),e._v(" "),s("li",[e._v("ä¸çŸ¥é“å“ªå¤©æ‰‹æ»‘äº†ä¸€ä¸‹ï¼Œè¯•ç”¨è´¦å·å˜æˆäº†ä»˜è´¹è´¦å·ï¼Œèµ é‡‘ $300 å°±è¿™æ ·æ²¡äº† ğŸ˜­ã€‚")])])]),e._v(" "),s("li",[e._v("ä½¿ç”¨ play with kubernetes\n"),s("ul",[s("li",[e._v("k8s æ‰€éœ€ç¯å¢ƒä¸ç”¨é…ï¼Œå·²ç»è£…å¥½äº†ï¼Œè¿™ä¸€ç‚¹å¾ˆä¸é”™ã€‚")]),e._v(" "),s("li",[e._v("å•å°æœºå™¨å®¹é‡å¤ªå°ï¼Œç¨å¾®å¤§ä¸€ç‚¹çš„é•œåƒå°±å®‰è£…ä¸è¿›å»äº†ã€‚")]),e._v(" "),s("li",[e._v("å¶å°”ä½¿ç”¨ play with kubernetes æ—¶ï¼Œåˆšæ–°å»ºå®Œä¸€ä¸ªå®ä¾‹ï¼Œå°±è¢«è¸¢ä¸‹çº¿ï¼Œé‡åˆ°è¿™ç§æƒ…å†µå°±æ²¡æ³•ç©ã€‚")]),e._v(" "),s("li",[e._v("æ²¡æœ‰æä¾›å…¬ç½‘ ipï¼Œæ— æ³•éªŒè¯å¤–ç½‘è®¿é—®æƒ…å†µã€‚")])])])]),e._v(" "),s("p",[e._v("æœ€åï¼Œæ¨èä¸€ä¸‹ã€Šæ¯å¤© 5 åˆ†é’Ÿç©è½¬ Kubernetesã€‹è¿™æœ¬ä¹¦ï¼Œä¸€æœ¬éå¸¸é€‚åˆå…¥é—¨ k8s çš„å®æˆ˜ä¹¦ã€‚ä¹¦ä¸­é€šè¿‡å¤§é‡çš„ç®€å•å®æˆ˜ï¼Œä»æ˜“åˆ°éš¾ï¼Œè®©æˆ‘çœŸæ­£ç†è§£äº† k8sï¼Œæœ¬æ–‡ä¸­çš„å¤§é‡ç†è®ºçŸ¥è¯†ä¹Ÿéƒ½æ¥è‡ªè¿™æœ¬ä¹¦ã€‚")]),e._v(" "),s("comment")],1)}),[],!1,null,null,null);t.default=n.exports}}]);